========================================================
Loading environment modules...
Environment loaded.

========================================================
Job ID: 5550
Node: gpuh08
Start time: 2025年 12月 15日 星期一 21:31:07 CST
Command: python local_run.py
========================================================
/public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/pyannote/audio/core/io.py:47: UserWarning: 
torchcodec is not installed correctly so built-in audio decoding will fail. Solutions are:
* use audio preloaded in-memory as a {'waveform': (channel, time) torch.Tensor, 'sample_rate': int} dictionary;
* fix torchcodec installation. Error message was:

Could not load libtorchcodec. Likely causes:
          1. FFmpeg is not properly installed in your environment. We support
             versions 4, 5, 6 and 7.
          2. The PyTorch version (2.9.0+cu128) is not compatible with
             this version of TorchCodec. Refer to the version compatibility
             table:
             https://github.com/pytorch/torchcodec?tab=readme-ov-file#installing-torchcodec.
          3. Another runtime dependency; see exceptions below.
        The following exceptions were raised as we tried to load libtorchcodec:
        
[start of libtorchcodec loading traceback]
FFmpeg version 7: Could not load this library: /public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torchcodec/libtorchcodec_core7.so
FFmpeg version 6: Could not load this library: /public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torchcodec/libtorchcodec_core6.so
FFmpeg version 5: Could not load this library: /public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torchcodec/libtorchcodec_core5.so
FFmpeg version 4: Could not load this library: /public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torchcodec/libtorchcodec_core4.so
[end of libtorchcodec loading traceback].
  warnings.warn(
/public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torch/backends/cuda/__init__.py:131: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = 'tf32' or torch.backends.cuda.matmul.fp32_precision = 'ieee'. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:80.)
  return torch._C._get_cublas_allow_tf32()
/public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/pyannote/audio/utils/reproducibility.py:74: ReproducibilityWarning: TensorFloat-32 (TF32) has been disabled as it might lead to reproducibility issues and lower accuracy.
It can be re-enabled by calling
   >>> import torch
   >>> torch.backends.cuda.matmul.allow_tf32 = True
   >>> torch.backends.cudnn.allow_tf32 = True
See https://github.com/pyannote/pyannote-audio/issues/1370 for more details.

  warnings.warn(
/public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/pyannote/audio/models/blocks/pooling.py:103: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at /pytorch/aten/src/ATen/native/ReduceOps.cpp:1857.)
  std = sequences.std(dim=-1, correction=1)
Processing video in ./video_database/Database/VLOG_Lisbon/frames...
[Skip] Found 15435 existing frames in ./video_database/Database/VLOG_Lisbon/frames, skipping frame extraction
ASR to SRT: ./video_database/Database/VLOG_Lisbon/subtitles.srt
[ASR] Limiting audio extraction to match frame extraction: 15435 frames @ 2 fps = 7717.50s (end_sec: 7717.50s)
[ASR] Using device: cuda:0
[ASR] Loading Whisper model: large-v3-turbo
[ASR] Transcribe options: no_speech_threshold=0.7, logprob_threshold=-0.8, compression_ratio_threshold=2.0
[ASR] Transcribing audio...
[ASR] Loading pyannote diarization pipeline...
[ASR] Loading audio for diarization...
[ASR] Performing speaker diarization...
[ASR] Merging ASR and diarization results...
Video processing completed.
========================================================
End time: 2025年 12月 15日 星期一 21:35:50 CST
========================================================
