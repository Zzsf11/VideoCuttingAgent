========================================================
Loading environment modules...
Environment loaded.

========================================================
Job ID: 5515
Node: gpuh10
Start time: 2025年 12月 15日 星期一 18:55:08 CST
Command: python run_asr.py /public_hw/home/cit_shifangzhao/zsf/VideoCuttingAgent/Dataset/Video/Titanic.1997.1080p.BluRay.x265-RARBG.mp4 -m large-v3
========================================================
/public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/pyannote/audio/core/io.py:47: UserWarning: 
torchcodec is not installed correctly so built-in audio decoding will fail. Solutions are:
* use audio preloaded in-memory as a {'waveform': (channel, time) torch.Tensor, 'sample_rate': int} dictionary;
* fix torchcodec installation. Error message was:

Could not load libtorchcodec. Likely causes:
          1. FFmpeg is not properly installed in your environment. We support
             versions 4, 5, 6 and 7.
          2. The PyTorch version (2.9.0+cu128) is not compatible with
             this version of TorchCodec. Refer to the version compatibility
             table:
             https://github.com/pytorch/torchcodec?tab=readme-ov-file#installing-torchcodec.
          3. Another runtime dependency; see exceptions below.
        The following exceptions were raised as we tried to load libtorchcodec:
        
[start of libtorchcodec loading traceback]
FFmpeg version 7: Could not load this library: /public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torchcodec/libtorchcodec_core7.so
FFmpeg version 6: Could not load this library: /public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torchcodec/libtorchcodec_core6.so
FFmpeg version 5: Could not load this library: /public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torchcodec/libtorchcodec_core5.so
FFmpeg version 4: Could not load this library: /public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torchcodec/libtorchcodec_core4.so
[end of libtorchcodec loading traceback].
  warnings.warn(
/public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/torch/backends/cuda/__init__.py:131: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = 'tf32' or torch.backends.cuda.matmul.fp32_precision = 'ieee'. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:80.)
  return torch._C._get_cublas_allow_tf32()
/public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/pyannote/audio/utils/reproducibility.py:74: ReproducibilityWarning: TensorFloat-32 (TF32) has been disabled as it might lead to reproducibility issues and lower accuracy.
It can be re-enabled by calling
   >>> import torch
   >>> torch.backends.cuda.matmul.allow_tf32 = True
   >>> torch.backends.cudnn.allow_tf32 = True
See https://github.com/pyannote/pyannote-audio/issues/1370 for more details.

  warnings.warn(
/public_hw/home/cit_shifangzhao/miniconda3/envs/VCA/lib/python3.12/site-packages/pyannote/audio/models/blocks/pooling.py:103: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at /pytorch/aten/src/ATen/native/ReduceOps.cpp:1857.)
  std = sequences.std(dim=-1, correction=1)
Using device: cuda
Extracting audio from video: /public_hw/home/cit_shifangzhao/zsf/VideoCuttingAgent/Dataset/Video/Titanic.1997.1080p.BluRay.x265-RARBG.mp4
Audio extracted to: /tmp/tmpmvi7wqxq.wav
Loading Whisper model: large-v3
Transcribing audio...
Loading pyannote diarization pipeline...
Loading audio for diarization...
Performing speaker diarization...
Merging results...
Cleaned up temporary audio file: /tmp/tmpmvi7wqxq.wav
SRT file saved to: /public_hw/home/cit_shifangzhao/zsf/VideoCuttingAgent/Dataset/Video/Titanic.1997.1080p.BluRay.x265-RARBG.srt
Done!
========================================================
End time: 2025年 12月 15日 星期一 19:23:11 CST
========================================================
